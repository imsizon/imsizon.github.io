<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>萨内蒂的小跟班的Blog</title><link href="https://imsizon.com/" rel="alternate"></link><link href="https://imsizon.com/feeds/miscellanies.atom.xml" rel="self"></link><id>https://imsizon.com/</id><updated>2014-03-28T18:10:32+08:00</updated><entry><title>再次折腾blog，从Octopress迁移到pelican</title><link href="https://imsizon.com/2014/03/28/replace-octopress-with-pelican/" rel="alternate"></link><updated>2014-03-28T18:10:32+08:00</updated><author><name>萨内蒂的小跟班</name></author><id>tag:imsizon.com,2014-03-28:2014/03/28/replace-octopress-with-pelican/</id><summary type="html">&lt;p&gt;发篇文章除除草……&lt;/p&gt;
&lt;p&gt;虽说上篇文章已经是11年底更新的了，这期间博客背后的东西却已经换了2次，Octopress刚流行的时候，就果断把自己用flask写的版本给翻了过来，为了类目中文别名及多类目支持等需求，改了jekyll不少代码，再之后因为博客不怎么更新，这些代码也就年久失修了，现在再要跟上已经有点麻烦。&lt;/p&gt;
&lt;p&gt;在简单搜了下替代方案后，从&lt;a href="http://blog.codylab.com/From-Octopress-To-Pelican/"&gt;这里（從 Octorpess 搬家到 Pelican
）&lt;/a&gt;发现了&lt;a href="https://github.com/getpelican/pelican"&gt;pelican&lt;/a&gt;，借助&lt;a href="http://jakevdp.github.io/blog/2013/05/07/migrating-from-octopress-to-pelican/"&gt;Migrating from Octopress to Pelican&lt;/a&gt;这篇文章，花了一晚上，顺利把Octopress换成了pelican，主题还是使用的&lt;a href="https://github.com/duilio/pelican-octopress-theme"&gt;Octopress主题&lt;/a&gt;，不过这个主题默认的archive页面有点问题，就是不会按照pelican默认的settings&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;NEWEST_FIRST_ARCHIVES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;行为，将文档按照时间倒序排列，需要在templates/archives.html的这里&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c"&gt;% for year, date_year in dates|groupby(&amp;#39;date.year&amp;#39;) %}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;和&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="c"&gt;% for month, articles in date_year|groupby(&amp;#39;date.month&amp;#39;) %}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里多加一个reverse的filter。&lt;/p&gt;</summary></entry><entry><title>搬家完毕，附带搬家过程中的问题小结</title><link href="https://imsizon.com/2010/04/06/Move-is-completed-the-process-of-moving-the-problem-with-summary/" rel="alternate"></link><updated>2010-04-06T21:53:48+08:00</updated><author><name>萨内蒂的小跟班</name></author><id>tag:imsizon.com,2010-04-06:2010/04/06/Move-is-completed-the-process-of-moving-the-problem-with-summary/</id><summary type="html">&lt;p&gt;&lt;p&gt; 博客搬家已经断断续续折腾了快半个月了，总算利用清明假期把东西都整理妥当，搬家过程中碰到了不少麻烦，一个是OpenVZ虚拟vps上的OpenVpn搭建及使用问题，还有一个是使用Fastcgi部署webpy时web.seeother(&amp;quot;/redirect-to&amp;quot;)跳转地址总会附加跳转前路径的问题。&lt;/p&gt; &lt;p&gt; 首先说OpenVpn的搭建和使用，Google一下可以找到很多教程，不过有些地方还是有问题的：&lt;/p&gt; &lt;p&gt; 1）在按照教程配置好OpenVpn服务并且启动后，需要配置iptable的nat转发规则，否则客户端连上之后不能通过服务器访问internet。大部分教程里面提供的语句都是&lt;/p&gt; &lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/usr/bin/bash&lt;/span&gt;
iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt; 这个在大部分OpenVZ的vps上应该是执行不了的，我对Linux不是很熟悉，猜测这个和OpenVZ虚拟的网卡功能受限制有关系，这时需要使用snat转发&lt;/p&gt;

&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;iptables -t nat -A POSTROUTING -s 192.168.8.0/24 -o venet0 -j SNAT --to *.*.*.*
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt; 2)连上OpenVpn后不管什么请求都要绕道国外的主机，访问国内网站自然速度会打个折扣，于是出现了&lt;a href="http://code.google.com/p/chnroutes/" target="_blank" title="chnroutes"&gt;chnroutes&lt;/a&gt;这样的工具，在OpenVpn客户端连接上服务端之后，设置国内ip段的通过正常的网关访问。不过chnroutes默认提供的脚本在多网卡环境下执行可能会出问题，主要是多块网卡中有设置静态ip之后，chnroutes取到的网关不一定是当前实际使用的网关（Windows环境下，其他环境下可能有类似问题），因此将脚本最开始获取当前网关的语句调整了一下&lt;/p&gt;

&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;@Rem &lt;span class="k"&gt;for&lt;/span&gt; /F &lt;span class="s2"&gt;&amp;quot;tokens=3&amp;quot;&lt;/span&gt; %%* in &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;route print ^| findstr &amp;quot;\&amp;lt;0.0.0.0\&amp;gt;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;gw=%%*&amp;quot;&lt;/span&gt; &lt;span class="c"&gt;#原始脚本&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; /F &lt;span class="s2"&gt;&amp;quot;tokens=3&amp;quot;&lt;/span&gt; %%* in &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;route print ^| findstr &amp;quot;\&amp;lt;0.0.0.0.*[0-9]$&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do &lt;/span&gt;
&lt;span class="k"&gt;    if &lt;/span&gt;not &lt;span class="s2"&gt;&amp;quot;%%*&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;192.168.8.5&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;gw=%%*&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c"&gt;#修改后的脚本&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt; 使用时将192.168.8.5替换成vpn链接获取到的实际网关（可以从gui的log中看到），这样就没有问题了。另外Windows下OpenVpn-gui程序在连接成功后设置route规则的语句总是执行不成功，需要手动重新添加，这部分语句也可以加到chnroutes的脚本中。&lt;/p&gt;

&lt;p&gt;&lt;p&gt; 然后就是通过Fastcgi部署博客应用的问题了。这次用webpy把博客重新实现了一下，webpy的跳转功能api似乎有些问题，在本机测试的时候302，303跳转都很正常，但是通过fastcgi启动之后就会出问题，具体症状就是跳转后的地址总会附加跳转前的路径。Google了一下，似乎0.3版本一直都有这个问题，邮件列表中问这个问题的人也不少，但却没见作者做明确答复。有人说在nginx的配置中加上将REAL_SCRIPT_NAME置空的语句，实际测试没有效果。最后实在没办法，只好在将webpy的跳转方法包装了一下，在跳转地址的前面附加上应用的域名，总算ok了。这样做的麻烦就是必须配置应用的域名，否则涉及到跳转的地方就会error 500了。&lt;/p&gt; &lt;p&gt; 至此，博客搬家告一段落，后面会陆续对代码做重构和优化，还有评论栏考虑增加&amp;ldquo;记住我&amp;rdquo;的功能，解决某些同学Firefox的greasemonkey脚本配置失败的问题。&lt;/p&gt; &lt;p&gt; 最后试验一下图片上传功能，预祝明天凌晨球队顺利晋级欧冠4强：&lt;/p&gt; &lt;p&gt; &lt;img alt="" src="/images/2010/04/06/1270533208.jpg" style="width: 491px; height: 420px;" /&gt;&lt;/p&gt;&lt;/p&gt;</summary></entry><entry><title>继续折腾，本博搬家准备中</title><link href="https://imsizon.com/2010/03/18/Continue-to-toss-move-in-preparation-of-the-Bo/" rel="alternate"></link><updated>2010-03-18T05:29:46+08:00</updated><author><name>萨内蒂的小跟班</name></author><id>tag:imsizon.com,2010-03-18:2010/03/18/Continue-to-toss-move-in-preparation-of-the-Bo/</id><summary type="html">&lt;p&gt;&lt;p&gt;虽然最近事情多了，人也忙了，不过折腾的劲头丝毫不减，在果断的买了HelloHost的VPS后，本博的搬家也就摆上了日程。&lt;/p&gt;
 &lt;p&gt;不过VPS开通的第一件事不是搭Web也不是搭防火墙，而是屁颠屁颠的赶紧弄上OpenVpn，这下上推就方便多了，看youtube也快多了，再见了Your Freedom &amp;amp;&amp;amp; Tor。另，没有VPS又嫌Your Freedom和Tor速度慢的同学可以尝试一下“张生”（详细介绍参见“&lt;a target="_blank" href="http://code.google.com/p/scholarzhang/"&gt;西厢计划&lt;/a&gt;”，&lt;a target="_blank" href="http://blog.youxu.info/2010/03/14/west-chamber/"&gt;原理介绍&lt;/a&gt;，&lt;a target="_blank" href="http://twitbrowser.net/blog/2578"&gt;最方便的打包使用介绍&lt;/a&gt;），能够直接穿墙上推看YouTube。&lt;/p&gt;
  &lt;p&gt;说起推特上的生活，那真是五花八门，既有有用的信息更有各种八卦猛料，比混BBS和校内有趣多了，当然前提是得Follow恰当的人先，强烈推荐有条件的同学早日上推吧，DEEN同学已经响应号召注册账号了，可惜还不活跃啊。&lt;/p&gt;
 &lt;p&gt;啰嗦半天，扯回正题，因为博客搬家之后底层的数据库要切换回MySql，所以代码也需要做相应修改，对本博有什么修改意见的话同学们就抓紧提一提吧。现在很多东西都在我的控制范围之内了，有些以前不方便实现的功能现在可以正常实现鸟。&lt;/p&gt;
 &lt;p&gt;最后猛赞一下凌晨球队的表现，居然在斯坦福桥搞定了切尔西昂首晋级八强，实在长脸啊，希望后面能够走得更远。&lt;/p&gt;
 &lt;p&gt;&lt;img src="http://i3.sinaimg.cn/ty/cr/2010/0317/2934017613.jpg" title="比分" alt="比分" border="0" width="500" height="331" /&gt;&lt;br /&gt;
 &lt;/p&gt;
 &lt;p&gt;&lt;img src="http://i0.sinaimg.cn/ty/cr/2010/0317/3813273761.jpg" title="庆祝胜利" alt="庆祝胜利" border="0" width="500" height="331" /&gt;&lt;br /&gt;
 &lt;/p&gt;&lt;/p&gt;</summary></entry><entry><title>从java折腾到python</title><link href="https://imsizon.com/2010/02/26/Toss-to-python-from-java/" rel="alternate"></link><updated>2010-02-26T04:21:38+08:00</updated><author><name>萨内蒂的小跟班</name></author><id>tag:imsizon.com,2010-02-26:2010/02/26/Toss-to-python-from-java/</id><summary type="html">&lt;p&gt;&lt;p&gt;利用闲闲散散的时间终于把博客用python重新实现完了，这页面加载速度，真是让人泪流满面。log中看到的首次页面加载时间从原来的10+s降到了现在的1s左右，cpu时间消耗自然是大幅降低，另外gae python对静态文件配置的支持要比gae java好不少，可以指定文件的过期时间，可以进一步降低对服务器的资源消耗提高页面二次访问速度。这下估计每天访问量上到5000+（2010-03-01update：根据dashboard的资源消耗统计数据计算看可以支持50000+request/day，平均每个页面5个request的话也可以支撑10000+页面访问了），应该都不需要额外购买google的服务器配置了，购买虚拟主机的计划就往后搁置一下吧，估计上半年也没太多时间打理。&lt;/p&gt; &lt;p&gt;凌晨的比赛国米终于坚挺了一把，2：1把车仔拿下，真是让内拉祖里们内牛满面呐，希望下回合客场能继续保持本场的防守水准和反击效率。曾哥的禁区内扣球过人射门简直是如臻化境，屡试不爽了现在，看来以后得以信曾哥为主了。&lt;/p&gt; &lt;/p&gt;</summary></entry><entry><title>生命不止，折腾不息</title><link href="https://imsizon.com/2010/01/26/More-than-life-endless-torment/" rel="alternate"></link><updated>2010-01-26T06:20:00+08:00</updated><author><name>萨内蒂的小跟班</name></author><id>tag:imsizon.com,2010-01-26:2010/01/26/More-than-life-endless-torment/</id><summary type="html">&lt;p&gt;&lt;p&gt;每次看着系统日志里面博客的启动时间长达10s以上我就有股冲动整个完全由自己控制的虚拟主机，8过转了一圈也没发现什么便宜的支持java的方案，无奈之下就想拖鞋一下用个PHP的算了，好用的话顺带当个相册使了，看着&lt;a target="_blank" href="http://typecho.org"&gt;typecho&lt;/a&gt;就挺不错的，顺便也能把在Godaddy买域名免费赠送的10G虚拟主机空间给用上了。&lt;/p&gt; &lt;p&gt;于是屁颠屁颠的开主机，设mysql，安装typecho，把一切都弄好之后，才悲剧的发现分配给我的ip已经被和谐掉了，不翻墙无法访问（奇怪的是用公司电信通的网络完全木有问题），怒啊~~~~~&lt;/p&gt; &lt;p&gt;贼心不死的把虚拟主机删了再建刷新ip，如是几把分配的ip依然在墙外，好吧，只能望墙兴叹了，8是每个访问我博客的人都会翻墙的。&lt;/p&gt; &lt;p&gt;转过头来继续打google app engine的主意，看起来python版本的冷启动速度貌似还可以，那就用Django再造一个轮子吧，顺带深入复习一下python的使用，嗯哼，这个基本上就是接下来一段时间业余生活的主要消遣了。&lt;/p&gt; &lt;p&gt;最后怒赞一把球队，9人应战的情况下完爆隔壁，特别点名表扬圣塞、曾哥、潘德夫、萨队、麦孔，以下是贴图时间：&lt;/p&gt; &lt;p&gt;&lt;img src="http://i1.sinaimg.cn/ty/cr/2010/0125/3570656238.jpg" title="潘德夫助攻曾哥首开纪录" alt="潘德夫助攻曾哥首开纪录" border="0" /&gt;&lt;br /&gt; &lt;/p&gt; &lt;p class="photo_comment"&gt;潘德夫助攻曾哥首开纪录&lt;/p&gt; &lt;p&gt;&lt;img src="http://i1.sinaimg.cn/ty/g/p/2010-01-25/U3948P6T12D4807484F44DT20100125054157.jpg" title="潘德夫任意球破门" alt="潘德夫任意球破门" border="0" width="500" height="331" /&gt;&lt;/p&gt; &lt;p class="photo_comment"&gt;潘德夫任意球破门&lt;/p&gt; &lt;p&gt;&lt;img src="http://i1.sinaimg.cn/ty/g/p/2010-01-25/U3948P6T12D4807506F44DT20100125063257.jpg" title="圣塞扑掉小罗点球" alt="圣塞扑掉小罗点球" border="0" width="500" height="331" /&gt;&lt;/p&gt; &lt;p class="photo_comment"&gt;圣塞扑掉小罗点球&lt;/p&gt; &lt;p&gt;&lt;img src="http://i3.sinaimg.cn/ty/g/p/2010-01-25/U3948P6T12D4807445F44DT20100125051050.jpg" title="萨队的防守依旧生猛" alt="萨队的防守依旧生猛" border="0" width="500" height="331" /&gt;&lt;/p&gt; &lt;p class="photo_comment"&gt;萨队的防守依旧生猛&lt;/p&gt; &lt;p&gt;&lt;img src="http://i3.sinaimg.cn/ty/g/p/2010-01-25/U3948P6T12D4807510F44DT20100125063755.JPG" title="可爱的大马，戴面具讽刺家兔" alt="可爱的大马，戴面具讽刺家兔" border="0" width="500" height="331" /&gt;&lt;/p&gt; &lt;p class="photo_comment"&gt;可爱的大马，戴面具讽刺家兔&lt;/p&gt; &lt;p&gt;&lt;br /&gt; &lt;/p&gt; &lt;/p&gt;</summary></entry></feed>